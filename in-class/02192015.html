<!doctype html>
<html>
<head>
    <meta charset="utf8">

    <style>


    </style>
    <title>Animation </title>
    </head>
    <body>
      <canvas width=640 height=480></canvas>
    </body>

    <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>

       <script>
         var $canvas =$("canvas");
         var canvas = $canvas.get(0);
         var context = canvas.getContext('2d');


         var drawNeko = function(x,y){
           context.fillStyle ="seagreen";
           context.fillRect(x-5, y-5, 10, 10 );

         };
         // objects
         var cat = {
           x: 100,
           y: 100,
           dx: 2,
           dy: 2
         };


         var pointer ={
           x :0,
           y: 0

         };


         var update = function(animal){
           animal.x = animal.x + animal.dx;
           animal.y = animal.y + animal.dy;
         }

         var counter =0;
         var chaseTail = function (animal){
           counter = counter + .1;
           animal.dx = Math.sin(counter);
          animal.dy =  Math.cos(counter);
          //animal.x = 100 + Math.sin(counter) *20;
         //animal.y = 100 + Math.cos(counter) *20;
         };

var chasePointer =function(animal){
  if(pointer.x < animal.x){

        animal.dx = -1;
      }else {
        animal.dx = 1;

      }

if(pointer.y < animal.y){

      animal.dy = -1;

    }else{
      animal.dy =1;

    }

    if(Math.abs(animal.x - pointer.x) < 2){
     if(Math.abs(animal.y - pointer.y) < 2)  {
       behavior = sleep;
    }
    }
};


var wander =function(animal){
  if (animal.x > canvas.width || animal.x < 0){

      animal.dx = animal.dx * -1;

    }
    if (animal.y > canvas.height|| animal.y < 0){

      animal.dy = animal.dy * -1;
    }
};

var sleep = function(){
  animal.dx = 0;
  animal.dy = 0;


};

var behavior = chaseTail;

// here is my animation
var animate = function (){
      context.clearRect(0, 0, canvas.width, canvas.height);
      //  cat.x = cat.x + 1;
      update(cat);
      behavior(cat);
      drawNeko (cat.x, cat.y);
      setTimeout(animate, 16);
    };
// run on page
setTimeout(animate, 16);

$canvas.on ("click", function(){

    behavior = wander;

  });


  var converToCanvas = function(x,y) {
    var offset = $canvas.offset();
    var newX = x - offset.left;
    var newY = x - offset.top;
    return {

      x: newX,
      y: newY
    }
  };

$canvas.on("mousemove", function(e){
    var converted = convertToCanvas(e.pageX,e.pageY);
  //  pointer.x = e.pageX;
    //pointer.y = e.pageY;
    pointer.x = e.converted.X;
    pointer.y = e.converted.Y;
    behavior = chasePointer;


  });
setTimeout(animate, 1* 1000);
     </script>

    </html>
